\documentclass[onecolumn, draftclsnofoot,10pt, compsoc]{IEEEtran}

\usepackage{graphicx}
\usepackage{url}
\usepackage{setspace}
\usepackage{geometry}
\usepackage{listings}
\usepackage{color}
\usepackage{etoolbox}
\usepackage{pdflscape}
\usepackage{titling}

\geometry{textheight=9.5in, textwidth=7in}

\def\name{Group 26}


\title{Homework 3s Report\\\large CS444 Fall17}
\author{Zach Lerew, Rohan Barve\\\large Group 26}
\date{\today}

% Syntax highlighting
\lstset{
  basicstyle=\footnotesize,        % size of fonts used for the code
  breaklines=true,                 % automatic line breaking only at whitespace
	frame = single,                  % code framing
}



\begin{document}
  % Title page
  \maketitle

	\begin{titlingpage}
		\begin{abstract}
			\noindent Homework 3 involves building an encrypted block device driver using the Linux crypto API and a reference from LDD3.
      The module's task is to encrypt and decrypt data as it is written and read from physical storage.
      The module will be designed, developed, transferred to a running VM using SCP, inserted into the module list, and then tested.
		\end{abstract}
	\end{titlingpage}

  \pagenumbering{arabic}
  \clearpage
  \singlespace

	% Document body
	\section*{Design}
  For this assignment, the team was given a reference driver through the LDD3 manual online.
  Additionally, our research has lead us to the blog of Pat Patterson, who has updated the LDD3 reference driver for the Linux Kernel v2.6.31. \cite{pat}
  The team chose to first test a reference device driver available using the LDD3 resource and then added encryption to the existing device driver, testing it for correctness on the qemu VM.

	\section*{Questions}
	\subsection*{1.What do you think the main point of this assignment is?}
	The main point of this assignment was to write a device driver for the Linux yocto kernel.
	Understand the block device interface, utilize the kernel's crypto API and practice kernel
	coding skills.

	\subsection*{2.How did you personally approach the problem? Design decisions, algorithm, etc.}
	The way our team approached this problem was to first use the LDD3 reference to read up on block device drivers and understand how the interface works. We then utilized an example device driver source file found on Pat Patterson's blog and tested it with our current kernel and VM setup.

	\subsection*{3.How did you ensure your solution was correct? Testing details, for instance.}

	\begin{enumerate}

	\item Source environment
	\begin{lstlisting}
source <environment-file>
\end{lstlisting}

	\item Clean and build kernel
	\begin{lstlisting}
cd linux-yocto-3.19
make clean && make -j4 all
\end{lstlisting}

	\item Run qemu using this command, which enables networking and file transfer with Description
	\begin{lstlisting}
qemu-system-i386 -redir tcp:<PORT>::22 -nographic -kernel linux-yocto-3.19/arch/x86/boot/bzImage -drive file=core-image-lsb-sdk-qemux86.ext4 -enable-kvm -usb -localtime --no-reboot --append ``root=/dev/hda rwconsole=ttyS0 debug``
\end{lstlisting}

\item Build module
\begin{lstlisting}
cd <path_to_module>
make
\end{lstlisting}

	\item Transfer module to VM with SCP
	\begin{lstlisting}
cd <path_to_module>
scp -P <PORT> <module.ko> root@localhost:~
\end{lstlisting}

	\item Insert module
	\begin{lstlisting}
cd ~
insmod <module.ko>
shred -z /dev/<module>0
mkfs.ext2 /dev/<module>0
mount /dev/<module>0 /mnt/
lsmod
\end{lstlisting}

	\item Test module to confirm that it works
	\begin{lstlisting}
	echo "Create test file"
	touch /mnt/testfile
	ls -la /mnt/

	echo "Insert test data"
	echo "Test Data" > /mnt/testfile
	cat /mnt/testfile

	echo "Search for test data in module"
	grep -a "Test Data" /dev/<module>0

	echo "Display contents of module"
	cat /dev/<module>0

	echo "Display contents of test file"
	cat /mnt/testfile

	echo "Delete test file"
	rm /mnt/testfile
\end{lstlisting}

\item Remove module
\begin{lstlisting}
umount /mnt
rmmod sbd_enc.ko
lsmod
\end{lstlisting}

	\end{enumerate}

	\subsection*{4.What did you learn?}


	\section*{Work log}
  	\begin{center}
    	\begin{tabular}{ |c|c|c| }
    		\hline
    		Date & Author & Description \\
    		\hline
    		yyyy-mm-dd & First Last & Text \\
    		\hline
    	\end{tabular}
  	\end{center}


  %References
  \bibliography{ref}
  \bibliographystyle{IEEEtran}

\end{document}
